# ===========================================
# API Server Configuration
# ===========================================
# Copy this file to .env and fill in your values.

# ===========================================
# Database (Required)
# ===========================================

# PostgreSQL connection string
# For local development with docker-compose:
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/szukaj_ksiazek?schema=public"

# For Docker internal networking:
# DATABASE_URL="postgresql://postgres:postgres@postgres:5432/szukaj_ksiazek?schema=public"

# ===========================================
# Authentication (Required)
# ===========================================

# JWT Secrets - generate with: openssl rand -base64 32
JWT_ACCESS_SECRET="your-access-secret-change-in-production"
JWT_REFRESH_SECRET="your-refresh-secret-change-in-production"

# Token expiration
JWT_ACCESS_EXPIRATION="15m"
JWT_REFRESH_EXPIRATION="7d"

# ===========================================
# AI Integration (Required)
# ===========================================

# Anthropic Claude API Key
# Get your key at: https://console.anthropic.com/
ANTHROPIC_API_KEY="sk-ant-your-key-here"

# ===========================================
# BUYBOX Offers API (Required for price comparison)
# ===========================================

# Widget ID from BUY.BOX publisher panel
# Used for endpoint: https://buybox.click/{WIDGET_ID}/buybox.json
BUYBOX_WIDGET_ID="your-buybox-widget-id"

# Request timeout in milliseconds
BUYBOX_TIMEOUT=10000

# Cache TTL in seconds (how long to cache offers)
BUYBOX_CACHE_TTL=3600

# Maximum retries on API failure
BUYBOX_MAX_RETRIES=3

# ===========================================
# BUYBOX Transactions API (Optional - for purchase history)
# ===========================================

# API Token from BUY.BOX publisher panel
BUYBOX_API_TOKEN="your-buybox-api-token"

# Space ID (publisher account identifier)
BUYBOX_SPACE_ID="your-buybox-space-id"

# Base URL for Transactions API
BUYBOX_API_BASE_URL="https://api.buybox.click"

# Transactions fetch settings
BUYBOX_TRANSACTIONS_PER_PAGE=50
BUYBOX_TRANSACTIONS_LOOKBACK_DAYS=90
BUYBOX_TRANSACTIONS_MAX_PAGES=20

# Campaign ID to Store Name Mappings (optional, JSON array)
# Format: [{"campId": "camp1", "storeName": "Store Name", "storeLogoUrl": "https://..."}]
# BUYBOX_CAMPAIGN_MAPPINGS='[{"campId":"empik","storeName":"Empik"}]'

# ===========================================
# Purchase History Provider
# ===========================================

# true = use mock provider (development)
# false = use real BUYBOX (production)
# If not set, auto-detects based on NODE_ENV
USE_MOCK_PURCHASES="true"

# ===========================================
# Application Settings
# ===========================================

# Server port
PORT=3000

# Environment: development | production | test
NODE_ENV="development"

# CORS Origins (comma-separated)
# Include all frontend URLs that should access the API
CORS_ORIGINS="http://localhost:8081,http://localhost:19006,http://localhost:3000"

# ===========================================
# Logging (Optional)
# ===========================================

# Log level: debug | info | warn | error
LOG_LEVEL="debug"

# Enable structured JSON logging (for production)
LOG_JSON="false"

# ===========================================
# Notes
# ===========================================
# 1. All values with "your-" prefix must be replaced with real values
# 2. Generate secure random secrets for production
# 3. Never commit .env files with real credentials
# 4. BUYBOX integration is optional - the app works without it
# 5. Use USE_MOCK_PURCHASES=true for development without BUYBOX
